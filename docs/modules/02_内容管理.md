# å†…å®¹ç®¡ç† API æ–‡æ¡£

## ğŸ“‹ æ¨¡å—æ¦‚è¿°

å†…å®¹ç®¡ç†æ¨¡å—æä¾›å†…å®¹çš„è§£æã€ä¿å­˜ã€æŸ¥è¯¢ã€ä¸‹è½½ã€å¯¼å‡ºã€åˆ é™¤å’ŒAIåˆ†æåŠŸèƒ½ï¼Œæ˜¯ç³»ç»Ÿçš„æ ¸å¿ƒæ¨¡å—ã€‚

**æ¥å£æ•°é‡**: 16ä¸ª
**åŸºç¡€è·¯å¾„**: `/api/v1/content`
**è®¤è¯è¦æ±‚**: æ‰€æœ‰æ¥å£å‡ä¸éœ€è¦è®¤è¯ï¼ˆå½“å‰é…ç½®ï¼‰

---

## ğŸ“‘ ä¸»è¦æ¥å£åˆ—è¡¨

| æ¥å£ | æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|------|
| è§£æå†…å®¹é“¾æ¥ | POST | `/parse` | è§£æé“¾æ¥æå–å…ƒæ•°æ® |
| ä¿å­˜å†…å®¹ | POST | `/save` | ä¿å­˜åˆ°æ•°æ®åº“å’Œæ–‡ä»¶ç³»ç»Ÿ |
| è·å–å†…å®¹åˆ—è¡¨ | GET | `/` | åˆ†é¡µæŸ¥è¯¢ï¼ˆæ”¯æŒç­›é€‰ï¼‰ |
| è·å–å†…å®¹è¯¦æƒ… | GET | `/:id` | æ ¹æ® ID è·å–è¯¦æƒ… |
| åˆ é™¤å†…å®¹ | DELETE | `/:id` | åˆ é™¤å•æ¡å†…å®¹ |
| æ‰¹é‡åˆ é™¤ | POST | `/batch-delete` | æ‰¹é‡åˆ é™¤å†…å®¹ |
| æ‰¹é‡å¯¼å‡º | POST | `/export` | å¯¼å‡ºä¸º Excel |
| åˆ·æ–°ç»Ÿè®¡ | POST | `/:id/refresh-stats` | åˆ·æ–°äº’åŠ¨æ•°æ® |
| AIåˆ†æ | POST | `/:id/ai-analyze` | AI åˆ†æå†…å®¹ |
| AIçŠ¶æ€ | GET | `/:id/ai-status` | è·å–åˆ†æçŠ¶æ€ |
| ä¸‹è½½å†…å®¹ | POST | `/download` | ä¸‹è½½åª’ä½“æ–‡ä»¶ |
| æœ¬åœ°åª’ä½“ | GET | `/:id/local-media` | è®¿é—®æœ¬åœ°æ–‡ä»¶ |
| ä»£ç†ä¸‹è½½ | GET | `/proxy-download` | ä»£ç†å¤–éƒ¨æ–‡ä»¶ |
| ä»£ç†å›¾ç‰‡ | GET | `/proxy-image` | ä»£ç†å¤–éƒ¨å›¾ç‰‡ |
| ä¸‹è½½å¯¼å‡º | GET | `/download-export` | ä¸‹è½½ Excel |
| AIæ ‡ç­¾ç»Ÿè®¡ | GET | `/ai-tags/stats` | æ ‡ç­¾ç»Ÿè®¡ä¿¡æ¯ |

---

## 2.1 è§£æå†…å®¹é“¾æ¥

**åŸºæœ¬ä¿¡æ¯**
- **ç«¯ç‚¹**: `POST /api/v1/content/parse`
- **åŠŸèƒ½**: è§£æå¹³å°å†…å®¹é“¾æ¥ï¼Œæå–å…ƒæ•°æ®ï¼ˆä¸ä¸‹è½½ï¼‰
- **è®¤è¯**: âŒ ä¸éœ€è¦

### è¯·æ±‚å‚æ•°

| å‚æ•°å | ç±»å‹ | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|------|------|--------|
| link | string | âœ… | ä½œå“é“¾æ¥ | `"https://www.xiaohongshu.com/..."` |

### æˆåŠŸå“åº” (201 Created)

```json
{
  "message": "è§£ææˆåŠŸ",
  "title": "ä½œå“æ ‡é¢˜",
  "author": "ä½œè€…åç§°",
  "platform": "xiaohongshu",
  "content_id": "64f123abc",
  "description": "æè¿°",
  "media_type": "video",
  "cover_url": "https://...",
  "media_url": "https://...",
  "all_images": ["https://..."],
  "all_videos": ["https://..."],
  "like_count": 1234,
  "collect_count": 567,
  "comment_count": 89,
  "share_count": 45,
  "view_count": 10000,
  "publish_time": "2025-12-28T10:00:00.000Z",
  "tags": ["æ ‡ç­¾1"],
  "source_url": "åŸå§‹é“¾æ¥",
  "source_type": 1
}
```

### ä»£ç ç¤ºä¾‹

**cURL**:
```bash
curl -X POST "http://localhost:3000/api/v1/content/parse" \
  -H "Content-Type: application/json" \
  -d '{"link": "https://www.xiaohongshu.com/..."}'
```

**JavaScript (Axios)**:
```javascript
const parseContent = async (link) => {
  const response = await axios.post('/api/v1/content/parse', { link });
  return response.data;
};
```

### æ³¨æ„äº‹é¡¹

- âš ï¸ ä»…è§£æå…ƒæ•°æ®ï¼Œä¸ä¸‹è½½æ–‡ä»¶
- âœ… æ”¯æŒå¹³å°ï¼šå°çº¢ä¹¦ âœ…ã€æŠ–éŸ³ âš ï¸
- ğŸ“ é”™è¯¯æ—¥å¿—ï¼š`backend/logs/parse-error.log`

---

## 2.3 è·å–å†…å®¹åˆ—è¡¨

**åŸºæœ¬ä¿¡æ¯**
- **ç«¯ç‚¹**: `GET /api/v1/content/`
- **åŠŸèƒ½**: åˆ†é¡µæŸ¥è¯¢ï¼Œæ”¯æŒå¤šæ¡ä»¶ç­›é€‰
- **è®¤è¯**: âŒ ä¸éœ€è¦

### è¯·æ±‚å‚æ•°

| å‚æ•°å | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|--------|------|
| page | number | âŒ | 1 | é¡µç  |
| page_size | number | âŒ | 10 | æ¯é¡µæ•°é‡ |
| platform | string | âŒ | - | å¹³å°ç­›é€‰ |
| media_type | string | âŒ | - | åª’ä½“ç±»å‹ |
| author | string | âŒ | - | ä½œè€…ç­›é€‰ |
| keyword | string | âŒ | - | å…³é”®è¯æœç´¢ |
| tags | string | âŒ | - | æ ‡ç­¾ç­›é€‰ |
| start_date | string | âŒ | - | å¼€å§‹æ—¥æœŸ |
| end_date | string | âŒ | - | ç»“æŸæ—¥æœŸ |

### æˆåŠŸå“åº” (200 OK)

```json
{
  "message": "è·å–æˆåŠŸ",
  "data": {
    "list": [
      {
        "id": "uuid",
        "title": "æ ‡é¢˜",
        "author": "ä½œè€…",
        "platform": "xiaohongshu",
        "media_type": "video",
        "cover_url": "https://...",
        "like_count": 1234,
        "created_at": "2025-12-28T12:00:00.000Z",
        "tags": [...]
      }
    ],
    "total": 100,
    "page": 1,
    "page_size": 20
  }
}
```

---

## é™„å½•

### æ”¯æŒçš„å¹³å°

| å¹³å° | è§£æ | ä¸‹è½½ | çŠ¶æ€ |
|------|------|------|------|
| å°çº¢ä¹¦ | âœ… | âœ… | å®Œæ•´æ”¯æŒ |
| æŠ–éŸ³ | âœ… | âš ï¸ | å—åçˆ¬é™åˆ¶ |
| å¾®åš | âŒ | âŒ | å¼€å‘ä¸­ |

### åª’ä½“ç±»å‹

- `video`: è§†é¢‘å†…å®¹
- `image`: å›¾ç‰‡å†…å®¹

### æ¥æºç±»å‹

- `1`: å•é“¾æ¥è§£æ
- `2`: ç›‘æ§ä»»åŠ¡é‡‡é›†

---

## ç›¸å…³æ–‡æ¡£

- [Content å®ä½“](../data_models/Content_å®ä½“.md)
- [AIé…ç½®æ¨¡å—](./07_AIé…ç½®.md)

---

**æœ€åæ›´æ–°**: 2025-12-28
