# ğŸš€ videoAll CI/CD å®Œæ•´éƒ¨ç½²æŒ‡å—

## ğŸ“‹ ç›®å½•

- [æ¦‚è¿°](#æ¦‚è¿°)
- [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡)
- [å·²é…ç½®çš„å·¥ä½œæµ](#å·²é…ç½®çš„å·¥ä½œæµ)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [è¯¦ç»†é…ç½®](#è¯¦ç»†é…ç½®)
- [ä½¿ç”¨æŒ‡å—](#ä½¿ç”¨æŒ‡å—)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)

---

## æ¦‚è¿°

æœ¬é¡¹ç›®å·²é…ç½®å®Œæ•´çš„ GitHub Actions CI/CD è‡ªåŠ¨åŒ–æµç¨‹ï¼Œå®ç°ï¼š

- âœ… **æŒç»­é›†æˆ (CI)**ï¼šä»£ç æ¨é€è‡ªåŠ¨æµ‹è¯•ã€ä»£ç æ£€æŸ¥ã€å®‰å…¨æ‰«æ
- âœ… **Docker é•œåƒæ„å»º**ï¼šè‡ªåŠ¨æ„å»ºå¹¶æ¨é€åˆ° GHCR å’Œ Docker Hub
- âœ… **ç‰ˆæœ¬å‘å¸ƒ**ï¼šè‡ªåŠ¨åŒ–åˆ›å»º Release å’Œå‘å¸ƒé•œåƒ
- âœ… **é€šçŸ¥é›†æˆ**ï¼šæ”¯æŒé’‰é’‰ã€Slack é€šçŸ¥
- âœ… **å®‰å…¨æ‰«æ**ï¼šè‡ªåŠ¨æ‰«æä»£ç å’Œé•œåƒæ¼æ´

---

## æ¶æ„è®¾è®¡

### å·¥ä½œæµæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     GitHub Actions                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ CI å·¥ä½œæµ     â”‚  â”‚ Docker æ„å»º   â”‚  â”‚ ç‰ˆæœ¬å‘å¸ƒ     â”‚    â”‚
â”‚  â”‚ .github/      â”‚  â”‚ .github/      â”‚  â”‚ .github/      â”‚    â”‚
â”‚  â”‚ workflows/    â”‚  â”‚ workflows/    â”‚  â”‚ workflows/    â”‚    â”‚
â”‚  â”‚ ci.yml       â”‚  â”‚ docker-build  â”‚  â”‚ release.yml  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ .yml         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚         â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚          â”‚
â”‚         â–¼                     â”‚                â–¼          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æµ‹è¯•    â”‚        â”‚  Docker é•œåƒ â”‚    â”‚  Release â”‚   â”‚
â”‚  â”‚  æ„å»º    â”‚        â”‚  æ„å»º&æ¨é€   â”‚    â”‚  åˆ›å»º    â”‚   â”‚
â”‚  â”‚  æ‰«æ    â”‚        â”‚             â”‚    â”‚  æ‰“åŒ…    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                     â”‚                â”‚          â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                               â–¼                             â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚                    â”‚  GitHub Packages â”‚                   â”‚
â”‚                    â”‚  GHCR.io/        â”‚                   â”‚
â”‚                    â”‚  Docker Hub      â”‚                   â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å·²é…ç½®çš„å·¥ä½œæµ

### 1. æŒç»­é›†æˆ (CI) - `.github/workflows/ci.yml`

**è§¦å‘æ¡ä»¶ï¼š**
- æ¨é€ä»£ç åˆ° `main` æˆ– `develop` åˆ†æ”¯
- åˆ›å»º Pull Request

**æ‰§è¡Œä»»åŠ¡ï¼š**
```yaml
âœ… åç«¯æµ‹è¯•å’Œä»£ç æ£€æŸ¥
  - å¯åŠ¨ PostgreSQL æµ‹è¯•æ•°æ®åº“
  - è¿è¡Œå•å…ƒæµ‹è¯•
  - ESLint ä»£ç æ£€æŸ¥
  - ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š

âœ… å‰ç«¯æ„å»ºå’Œæµ‹è¯•
  - å®‰è£…ä¾èµ–å¹¶æ„å»º
  - ESLint ä»£ç æ£€æŸ¥
  - ä¸Šä¼ æ„å»ºäº§ç‰©

âœ… å®‰å…¨æ‰«æ
  - Trivy æ¼æ´æ‰«æ
  - ä¸Šä¼ åˆ° GitHub Security

âœ… Python SDK æ£€æŸ¥
  - ä»£ç æ£€æŸ¥ï¼ˆflake8ï¼‰
  - è¿è¡Œæµ‹è¯•
```

**ç¯å¢ƒé…ç½®ï¼š**
- Node.js 20
- Python 3.10
- PostgreSQL 15

---

### 2. Docker é•œåƒæ„å»º - `.github/workflows/docker-build.yml`

**è§¦å‘æ¡ä»¶ï¼š**
- æ¨é€ä»£ç åˆ° `main` æˆ– `develop` åˆ†æ”¯
- æ¨é€ç‰ˆæœ¬æ ‡ç­¾ï¼ˆå¦‚ `v1.0.0`ï¼‰
- æ‰‹åŠ¨è§¦å‘ï¼ˆå¯é€‰æ‹© registryï¼‰

**æ„å»ºé•œåƒï¼š**
```dockerfile
âœ… åç«¯é•œåƒ
   - ghcr.io/727566105/videoall/backend
   - åŸºäº node:20-alpine
   - é›†æˆ Pythonã€Tesseract OCR

âœ… å‰ç«¯é•œåƒ
   - ghcr.io/727566105/videoall/frontend
   - åŸºäº nginx:alpine
   - é¢„æ„å»º React åº”ç”¨

âœ… å®Œæ•´åº”ç”¨é•œåƒ
   - ghcr.io/727566105/videoall
   - åŒ…å«å‰ç«¯ + åç«¯ + Nginx
```

**é•œåƒæ ‡ç­¾ç­–ç•¥ï¼š**
```bash
# åˆ†æ”¯æ ‡ç­¾
ghcr.io/727566105/videoall/backend:main
ghcr.io/727566105/videoall/backend:develop

# ç‰ˆæœ¬æ ‡ç­¾ï¼ˆæ¨é€ git tag æ—¶ï¼‰
ghcr.io/727566105/videoall/backend:1.0.0
ghcr.io/727566105/videoall/backend:1.0
ghcr.io/727566105/videoall/backend:1

# Commit SHA æ ‡ç­¾
ghcr.io/727566105/videoall/backend:main-52d96c3

# Latest æ ‡ç­¾ï¼ˆä»… main åˆ†æ”¯ï¼‰
ghcr.io/727566105/videoall/backend:latest
```

**ç‰¹æ€§ï¼š**
- âœ… å¤šé˜¶æ®µæ„å»ºä¼˜åŒ–é•œåƒå¤§å°
- âœ… è‡ªåŠ¨ç¼“å­˜åŠ é€Ÿæ„å»º
- âœ… ç”Ÿæˆ SBOMï¼ˆè½¯ä»¶ç‰©æ–™æ¸…å•ï¼‰
- âœ… å®‰å…¨æ‰«æï¼ˆTrivyï¼‰
- âœ… æ”¯æŒæ¨é€åˆ° Docker Hubï¼ˆå¯é€‰ï¼‰

---

### 3. ç‰ˆæœ¬å‘å¸ƒ - `.github/workflows/release.yml`

**è§¦å‘æ¡ä»¶ï¼š**
- æ¨é€ç‰ˆæœ¬æ ‡ç­¾ï¼ˆå¦‚ `v1.0.0`ï¼‰
- æ‰‹åŠ¨è§¦å‘

**å‘å¸ƒæµç¨‹ï¼š**
```yaml
âœ… åˆ›å»º GitHub Release
   - è‡ªåŠ¨ç”Ÿæˆå˜æ›´æ—¥å¿—
   - åŸºäº git commits ç”Ÿæˆ
   - æ”¯æŒé¦–æ¬¡å‘å¸ƒæ£€æµ‹

âœ… å‘å¸ƒ Docker é•œåƒ
   - åç«¯é•œåƒ
   - å‰ç«¯é•œåƒ
   - è‡ªåŠ¨ç‰ˆæœ¬æ ‡ç­¾

âœ… å‘é€é€šçŸ¥ï¼ˆå¯é€‰ï¼‰
   - é’‰é’‰æœºå™¨äºº
   - Slack Webhook
```

---

## å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

1. **GitHub ä»“åº“**
   - å·²åˆ›å»º GitHub ä»“åº“
   - å·²æ¨é€ä»£ç åˆ°ä»“åº“

2. **æœ¬åœ°ç¯å¢ƒ**
   - Git
   - Node.js 20+
   - Dockerï¼ˆå¯é€‰ï¼Œç”¨äºæœ¬åœ°æµ‹è¯•ï¼‰

3. **é•œåƒä»“åº“ï¼ˆå¯é€‰ï¼‰**
   - Docker Hub è´¦å·ï¼ˆå¦‚éœ€æ¨é€åˆ° Docker Hubï¼‰
   - GitHub Container Registryï¼ˆè‡ªåŠ¨æä¾›ï¼‰

---

## è¯¦ç»†é…ç½®

### æ­¥éª¤ 1ï¼šé…ç½® GitHub Secrets

è®¿é—®ï¼š`https://github.com/727566105/videoAll/settings/secrets/actions`

#### å¿…éœ€é…ç½®ï¼ˆä»… Docker Hubï¼‰

å¦‚æœè¦æ¨é€åˆ° Docker Hubï¼Œæ·»åŠ ä»¥ä¸‹ Secretsï¼š

| Secret åç§° | è¯´æ˜ | è·å–æ–¹æ³• |
|------------|------|----------|
| `DOCKERHUB_USERNAME` | Docker Hub ç”¨æˆ·å | Docker Hub è´¦å·ç”¨æˆ·å |
| `DOCKERHUB_TOKEN` | Docker Hub è®¿é—®ä»¤ç‰Œ | Docker Hub â†’ Security â†’ Access Tokens |

**è·å– Docker Hub Tokenï¼š**
1. ç™»å½• https://hub.docker.com/
2. ç‚¹å‡»å³ä¸Šè§’å¤´åƒ â†’ Account Settings
3. Security â†’ New Access Token
4. æè¿°å¡«å†™ "GitHub Actions"
5. æƒé™é€‰æ‹© "Read, Write, Delete"
6. ç”Ÿæˆå¹¶ä¿å­˜ Token

#### å¯é€‰é…ç½®ï¼ˆé€šçŸ¥ï¼‰

**é’‰é’‰æœºå™¨äººï¼š**
1. é’‰é’‰ç¾¤ â†’ ç¾¤è®¾ç½® â†’ æ™ºèƒ½ç¾¤åŠ©æ‰‹ â†’ æ·»åŠ æœºå™¨äºº â†’ è‡ªå®šä¹‰
2. å®‰å…¨è®¾ç½®é€‰æ‹©"å…³é”®è¯"æˆ–"ç­¾å"
3. è·å– Webhook URL
4. æ·»åŠ  Secretï¼š`DINGTALK_WEBHOOK`

**Slack Webhookï¼š**
1. åˆ›å»º Slack Appï¼šhttps://api.slack.com/apps
2. å¯ç”¨ "Incoming Webhooks"
3. åˆ›å»º Webhook
4. æ·»åŠ  Secretï¼š`SLACK_WEBHOOK_URL`

---

### æ­¥éª¤ 2ï¼šé…ç½® GitHub Actionsï¼ˆå·²å®Œæˆï¼‰

âœ… å·²é…ç½®çš„å·¥ä½œæµæ–‡ä»¶ï¼š
- `.github/workflows/ci.yml`
- `.github/workflows/docker-build.yml`
- `.github/workflows/release.yml`

âœ… å·²é…ç½®çš„ Dockerfileï¼š
- `Dockerfile`ï¼ˆå®Œæ•´åº”ç”¨ï¼‰
- `backend/Dockerfile`ï¼ˆåç«¯ï¼‰
- `frontend/Dockerfile`ï¼ˆå‰ç«¯ï¼‰

âœ… å·²é…ç½®çš„ç¼–æ’æ–‡ä»¶ï¼š
- `docker-compose.yml`ï¼ˆæœ¬åœ°å¼€å‘ï¼‰

---

### æ­¥éª¤ 3ï¼šè§¦å‘å·¥ä½œæµ

#### æ–¹å¼ä¸€ï¼šè‡ªåŠ¨è§¦å‘ï¼ˆæ¨èï¼‰

**CI å·¥ä½œæµ + Docker æ„å»ºï¼š**
```bash
# æ¨é€ä»£ç åˆ° main åˆ†æ”¯
git push origin main
```

**ç‰ˆæœ¬å‘å¸ƒï¼š**
```bash
# åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾
git tag v1.0.0

# æ¨é€æ ‡ç­¾ï¼ˆè§¦å‘ release å·¥ä½œæµï¼‰
git push origin v1.0.0
```

#### æ–¹å¼äºŒï¼šæ‰‹åŠ¨è§¦å‘

1. è®¿é—® GitHub ä»“åº“
2. ç‚¹å‡» "Actions" æ ‡ç­¾
3. é€‰æ‹©å·¥ä½œæµï¼š
   - "Docker é•œåƒæ„å»ºä¸å‘å¸ƒ"
   - æˆ– "ç‰ˆæœ¬å‘å¸ƒ"
4. ç‚¹å‡» "Run workflow"
5. é€‰æ‹©å‚æ•°å¹¶è¿è¡Œ

---

## ä½¿ç”¨æŒ‡å—

### æœ¬åœ°å¼€å‘

#### ä½¿ç”¨ Docker Compose

```bash
# 1. å¤åˆ¶ç¯å¢ƒå˜é‡é…ç½®
cp .env.docker.example .env

# 2. ç¼–è¾‘é…ç½®ï¼ˆä¿®æ”¹æ•°æ®åº“å¯†ç ç­‰ï¼‰
vim .env

# 3. å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# 4. æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# 5. æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# 6. åœæ­¢æœåŠ¡
docker-compose down

# 7. åœæ­¢å¹¶æ¸…ç†æ•°æ®
docker-compose down -v
```

#### è®¿é—®åº”ç”¨

å¯åŠ¨æˆåŠŸåï¼š
- **å‰ç«¯ç•Œé¢**ï¼šhttp://localhost:80
- **åç«¯ API**ï¼šhttp://localhost:3000
- **API å¥åº·æ£€æŸ¥**ï¼šhttp://localhost:3000/api/v1/health

---

### ç‰ˆæœ¬å‘å¸ƒ

#### å‡†å¤‡å·¥ä½œ

1. **ç¡®è®¤æ‰€æœ‰æ›´æ”¹å·²æäº¤**
   ```bash
   git status
   ```

2. **æ›´æ–°ç‰ˆæœ¬å·**ï¼ˆå¯é€‰ï¼‰
   - ç¼–è¾‘ `package.json` ä¸­çš„ç‰ˆæœ¬å·
   - æˆ–ä½¿ç”¨ git tag ç›´æ¥æŒ‡å®šç‰ˆæœ¬

#### åˆ›å»ºç‰ˆæœ¬å‘å¸ƒ

```bash
# 1. åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾
git tag v1.0.0 -m "Release version 1.0.0"

# 2. æ¨é€æ ‡ç­¾åˆ° GitHub
git push origin v1.0.0

# 3. æŸ¥çœ‹å‘å¸ƒè¿›åº¦
# è®¿é—®ï¼šhttps://github.com/727566105/videoAll/actions
```

#### ç‰ˆæœ¬å·è§„èŒƒ

éµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬ (Semantic Versioning)ï¼š

```
vä¸»ç‰ˆæœ¬.æ¬¡ç‰ˆæœ¬.è¡¥ä¸ç‰ˆæœ¬

ç¤ºä¾‹ï¼š
v1.0.0  - æ­£å¼ç‰ˆæœ¬
v1.0.1  - Bug ä¿®å¤
v1.1.0  - æ–°åŠŸèƒ½
v2.0.0  - ç ´åæ€§å˜æ›´

é¢„å‘å¸ƒç‰ˆæœ¬ï¼š
v1.0.0-alpha.1  - Alpha ç‰ˆæœ¬
v1.0.0-beta.1   - Beta ç‰ˆæœ¬
v1.0.0-rc.1     - Release Candidate
```

---

### Docker é•œåƒä½¿ç”¨

#### æ‹‰å–é•œåƒ

```bash
# ä» GitHub Container Registry æ‹‰å–
docker pull ghcr.io/727566105/videoall/backend:latest
docker pull ghcr.io/727566105/videoall/frontend:latest
docker pull ghcr.io/727566105/videoall:latest

# ä» Docker Hub æ‹‰å–ï¼ˆå¦‚å·²é…ç½®ï¼‰
docker pull <username>/videoall-backend:latest
docker pull <username>/videoall-frontend:latest
docker pull <username>/videoall:latest
```

#### è¿è¡Œé•œåƒ

**æ–¹å¼ä¸€ï¼šä½¿ç”¨ docker-compose**
```bash
docker-compose up -d
```

**æ–¹å¼äºŒï¼šç›´æ¥è¿è¡Œ**
```bash
# åç«¯
docker run -d \
  --name videoall-backend \
  -p 3000:3000 \
  -e POSTGRES_HOST=your_db_host \
  -e POSTGRES_PASSWORD=your_password \
  ghcr.io/727566105/videoall/backend:latest

# å‰ç«¯
docker run -d \
  --name videoall-frontend \
  -p 80:80 \
  ghcr.io/727566105/videoall/frontend:latest
```

---

## æœ€ä½³å®è·µ

### Git å·¥ä½œæµ

#### åˆ†æ”¯ç­–ç•¥

```
main (ç”Ÿäº§ç¯å¢ƒï¼Œæœ€ç¨³å®š)
  â†‘
  â”œâ”€â”€ develop (å¼€å‘ç¯å¢ƒï¼Œé›†æˆæœ€æ–°åŠŸèƒ½)
  â”‚     â†‘
  â”‚     â”œâ”€â”€ feature/xxx (åŠŸèƒ½åˆ†æ”¯)
  â”‚     â”œâ”€â”€ fix/xxx (ä¿®å¤åˆ†æ”¯)
  â”‚     â””â”€â”€ hotfix/xxx (ç´§æ€¥ä¿®å¤)
```

#### å¼€å‘æµç¨‹

```bash
# 1. å¼€å‘æ–°åŠŸèƒ½
git checkout -b feature/new-feature

# 2. å¼€å‘å¹¶æäº¤
git add .
git commit -m "feat(feature): æ·»åŠ æ–°åŠŸèƒ½"

# 3. æ¨é€åˆ°è¿œç¨‹
git push origin feature/new-feature

# 4. åˆ›å»º Pull Request åˆ° develop
# åœ¨ GitHub ä¸Šåˆ›å»º PR

# 5. åˆå¹¶åè‡ªåŠ¨è§¦å‘ CI å·¥ä½œæµ
```

#### æäº¤è§„èŒƒ

ä½¿ç”¨ Conventional Commitsï¼š

```bash
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤é—®é¢˜
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼
refactor: é‡æ„
test: æµ‹è¯•ç›¸å…³
chore: æ„å»º/å·¥å…·é“¾

ç¤ºä¾‹ï¼š
git commit -m "feat(content): æ·»åŠ æ‰¹é‡åˆ é™¤åŠŸèƒ½"
git commit -m "fix(auth): ä¿®å¤ JWT ä»¤ç‰Œè¿‡æœŸé—®é¢˜"
git commit -m "docs(readme): æ›´æ–°éƒ¨ç½²è¯´æ˜"
```

---

### å®‰å…¨æœ€ä½³å®è·µ

#### 1. Secrets ç®¡ç†

âœ… **æ¨èåšæ³•ï¼š**
- ä½¿ç”¨ GitHub Secrets å­˜å‚¨æ•æ„Ÿä¿¡æ¯
- å®šæœŸè½®æ¢å¯†é’¥å’Œä»¤ç‰Œ
- ä½¿ç”¨æœ€å°æƒé™åŸåˆ™

âŒ **é¿å…ï¼š**
- åœ¨ä»£ç ä¸­ç¡¬ç¼–ç å¯†é’¥
- åœ¨æ—¥å¿—ä¸­æ‰“å°æ•æ„Ÿä¿¡æ¯
- å°† `.env` æ–‡ä»¶æäº¤åˆ°ä»“åº“

#### 2. é•œåƒå®‰å…¨

âœ… **æ¨èåšæ³•ï¼š**
- ä½¿ç”¨å®˜æ–¹åŸºç¡€é•œåƒ
- å®šæœŸæ›´æ–°åŸºç¡€é•œåƒ
- ä½¿ç”¨é root ç”¨æˆ·è¿è¡Œï¼ˆå·²é…ç½®ï¼‰
- å¯ç”¨å®‰å…¨æ‰«æï¼ˆå·²é…ç½®ï¼‰

#### 3. ä¾èµ–ç®¡ç†

```bash
# å®šæœŸæ›´æ–°ä¾èµ–
npm audit
npm audit fix

# ä½¿ç”¨ Dependabot è‡ªåŠ¨æ›´æ–°ä¾èµ–
# .github/dependabot.yml
```

---

### æ€§èƒ½ä¼˜åŒ–

#### 1. æ„å»ºç¼“å­˜

å·¥ä½œæµå·²é…ç½® GitHub Actions ç¼“å­˜ï¼š
```yaml
cache-from: type=gha
cache-to: type=gha,mode=max
```

#### 2. Docker å¤šé˜¶æ®µæ„å»º

ä½¿ç”¨å¤šé˜¶æ®µæ„å»ºå‡å°é•œåƒå¤§å°ï¼š
```dockerfile
# æ„å»ºé˜¶æ®µ
FROM node:20-alpine AS builder
# ... æ„å»ºä»£ç 

# è¿è¡Œé˜¶æ®µ
FROM node:20-alpine
COPY --from=builder /app/dist ./dist
```

#### 3. å¹¶è¡Œæ„å»º

ä½¿ç”¨ GitHub Actions çŸ©é˜µç­–ç•¥å¹¶è¡Œæ„å»ºï¼š
```yaml
strategy:
  matrix:
    component: [backend, frontend]
```

---

## ç›‘æ§ä¸è°ƒè¯•

### æŸ¥çœ‹å·¥ä½œæµçŠ¶æ€

**GitHub Actionsï¼š**
```
https://github.com/727566105/videoAll/actions
```

**æŸ¥çœ‹æ—¥å¿—ï¼š**
1. ç‚¹å‡»å…·ä½“çš„å·¥ä½œæµè¿è¡Œ
2. é€‰æ‹©è¦æŸ¥çœ‹çš„ä»»åŠ¡
3. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

### å¸¸è§é—®é¢˜æ’æŸ¥

#### 1. CI å·¥ä½œæµå¤±è´¥

**é—®é¢˜ï¼š** æµ‹è¯•å¤±è´¥
```bash
# æœ¬åœ°è¿è¡Œæµ‹è¯•
cd backend
npm test
```

**é—®é¢˜ï¼š** æ„å»ºè¶…æ—¶
```bash
# æ£€æŸ¥ä¾èµ–æ˜¯å¦æ­£ç¡®å®‰è£…
npm ci
```

#### 2. Docker æ„å»ºå¤±è´¥

**é—®é¢˜ï¼š** åŸºç¡€é•œåƒæ‹‰å–å¤±è´¥
```bash
# æ£€æŸ¥ç½‘ç»œè¿æ¥
# æˆ–ä½¿ç”¨ä»£ç†
```

**é—®é¢˜ï¼š** æ„å»ºç¼“å­˜é—®é¢˜
```yaml
# åœ¨ workflow ä¸­ç¦ç”¨ç¼“å­˜
cache-from: type=gha
cache-to: type=gha,mode=max
pull: true  # å¼ºåˆ¶æ‹‰å–æœ€æ–°é•œåƒ
```

#### 3. é•œåƒæ¨é€å¤±è´¥

**é—®é¢˜ï¼š** è®¤è¯å¤±è´¥
```bash
# æ£€æŸ¥ Secrets æ˜¯å¦æ­£ç¡®é…ç½®
# ç¡®è®¤ GITHUB_TOKEN æœ‰å†™å…¥æƒé™
# ç¡®è®¤ DOCKERHUB_TOKEN æœ‰æ•ˆ
```

**é—®é¢˜ï¼š** æ ‡ç­¾æ ¼å¼é”™è¯¯
```bash
# æ£€æŸ¥æ ‡ç­¾æ ¼å¼
# ç¡®è®¤æ²¡æœ‰ç‰¹æ®Šå­—ç¬¦
```

---

## é«˜çº§é…ç½®

### æ·»åŠ è‡ªå®šä¹‰ç¯å¢ƒå˜é‡

åœ¨ `.github/workflows/*.yml` ä¸­æ·»åŠ ï¼š

```yaml
env:
  MY_CUSTOM_VAR: ${{ secrets.MY_CUSTOM_VAR }}
```

### é…ç½®å®šæ—¶ä»»åŠ¡

åœ¨ `.github/workflows/ci.yml` ä¸­æ·»åŠ ï¼š

```yaml
on:
  schedule:
    - cron: '0 0 * * 0'  # æ¯å‘¨æ—¥ 00:00 è¿è¡Œ
```

### æ·»åŠ çŸ©é˜µæ„å»º

```yaml
strategy:
  matrix:
    node-version: [18, 20, 22]
    os: [ubuntu-latest, windows-latest]
```

---

## ç›¸å…³èµ„æº

### å®˜æ–¹æ–‡æ¡£

- [GitHub Actions æ–‡æ¡£](https://docs.github.com/en/actions)
- [Docker å®˜æ–¹æ–‡æ¡£](https://docs.docker.com/)
- [è¯­ä¹‰åŒ–ç‰ˆæœ¬](https://semver.org/lang/zh-CN/)
- [Conventional Commits](https://www.conventionalcommits.org/zh-hans/)

### é¡¹ç›®æ–‡æ¡£

- [CLAUDE.md](CLAUDE.md) - é¡¹ç›®æ¦‚è¿°å’Œå¼€å‘æŒ‡å—
- [.github/DEPLOYMENT.md](.github/DEPLOYMENT.md) - è¯¦ç»†éƒ¨ç½²æ–‡æ¡£
- [.github/README.md](.github/README.md) - å¿«é€Ÿå¼€å§‹æŒ‡å—

---

## è·å–å¸®åŠ©

### é—®é¢˜æ’æŸ¥

1. **æŸ¥çœ‹æ–‡æ¡£**
   - [CLAUDE.md](CLAUDE.md)
   - [.github/DEPLOYMENT.md](.github/DEPLOYMENT.md)

2. **æŸ¥çœ‹æ—¥å¿—**
   - GitHub Actions â†’ å·¥ä½œæµ â†’ æŸ¥çœ‹æ—¥å¿—

3. **æäº¤ Issue**
   - https://github.com/727566105/videoAll/issues

### è”ç³»æ–¹å¼

- **GitHub Issues**: https://github.com/727566105/videoAll/issues
- **Pull Requests**: https://github.com/727566105/videoAll/pulls

---

## æ€»ç»“

æœ¬é¡¹ç›®çš„ CI/CD æµç¨‹å·²å®Œå…¨é…ç½®ï¼Œæä¾›ï¼š

âœ… **è‡ªåŠ¨åŒ–æµ‹è¯•** - æ¯æ¬¡æ¨é€è‡ªåŠ¨è¿è¡Œæµ‹è¯•
âœ… **è‡ªåŠ¨æ„å»º** - è‡ªåŠ¨æ„å»º Docker é•œåƒ
âœ… **è‡ªåŠ¨å‘å¸ƒ** - æ¨é€æ ‡ç­¾è‡ªåŠ¨åˆ›å»º Release
âœ… **å®‰å…¨æ‰«æ** - è‡ªåŠ¨æ‰«ææ¼æ´
âœ… **é€šçŸ¥é›†æˆ** - æ”¯æŒé’‰é’‰ã€Slack
âœ… **å®Œæ•´æ–‡æ¡£** - è¯¦ç»†çš„éƒ¨ç½²å’Œä½¿ç”¨æ–‡æ¡£

å¼€å§‹ä½¿ç”¨ï¼šåªéœ€æ¨é€ä»£ç æˆ–åˆ›å»ºæ ‡ç­¾ï¼Œä¸€åˆ‡è‡ªåŠ¨å®Œæˆï¼

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0.0
**æœ€åæ›´æ–°ï¼š** 2025-12-29
**ç»´æŠ¤è€…ï¼š** 727566105
